<div class="flex h-screen bg-gray-100">
  <!-- Desktop Sidebar -->
  <aside class="hidden lg:block w-64 bg-gray-800 text-white p-6">
    <div class="flex items-center mb-8">
      <h2 class="text-xl font-semibold">My Dashboard</h2>
    </div>
    <nav>
      <ul>
        <li class="mb-4">
          <a 
            (click)="navigateToSection('students')" 
            class="flex items-center p-3 rounded-lg cursor-pointer transition-colors"
            [class.bg-teal-500]="currentView === 'students'"
            [class.text-white]="currentView === 'students'"
            [class.hover:bg-gray-700]="currentView !== 'students'"
            [class.text-gray-300]="currentView !== 'students'"
          >
            <span class="material-icons mr-4" [class.text-white]="currentView === 'students'" [class.text-gray-400]="currentView !== 'students'">school</span>
            <span>Students</span>
          </a>
        </li>
        <li class="mb-4">
          <a 
            (click)="navigateToSection('courses')" 
            class="flex items-center p-3 rounded-lg cursor-pointer transition-colors"
            [class.bg-teal-500]="currentView === 'courses'"
            [class.text-white]="currentView === 'courses'"
            [class.hover:bg-gray-700]="currentView !== 'courses'"
            [class.text-gray-300]="currentView !== 'courses'"
          >
            <span class="material-icons mr-4" [class.text-white]="currentView === 'courses'" [class.text-gray-400]="currentView !== 'courses'">book</span>
            <span>Courses</span>
          </a>
        </li>
        <li class="mb-4">
          <a 
            (click)="navigateToSection('overview')" 
            class="flex items-center p-3 rounded-lg cursor-pointer transition-colors"
            [class.bg-teal-500]="currentView === 'overview'"
            [class.text-white]="currentView === 'overview'"
            [class.hover:bg-gray-700]="currentView !== 'overview'"
            [class.text-gray-300]="currentView !== 'overview'"
          >
            <span class="material-icons mr-4" [class.text-white]="currentView === 'overview'" [class.text-gray-400]="currentView !== 'overview'">dashboard</span>
            <span>Overview</span>
          </a>
        </li>
        <li class="mb-4">
          <a 
            (click)="navigateToSection('messages')" 
            class="flex items-center p-3 rounded-lg cursor-pointer transition-colors"
            [class.bg-teal-500]="currentView === 'messages'"
            [class.text-white]="currentView === 'messages'"
            [class.hover:bg-gray-700]="currentView !== 'messages'"
            [class.text-gray-300]="currentView !== 'messages'"
          >
            <span class="material-icons mr-4" [class.text-white]="currentView === 'messages'" [class.text-gray-400]="currentView !== 'messages'">chat</span>
            <span>Messages</span>
            <span *ngIf="totalUnreadMessages > 0" class="ml-auto bg-red-500 text-white text-xs rounded-full px-2 py-1 min-w-[20px] text-center">
              {{ totalUnreadMessages }}
            </span>
          </a>
        </li>
      </ul>
    </nav>
  </aside>

  <!-- Mobile Menu Overlay -->
  <div 
    *ngIf="isMobileMenuOpen" 
    class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40"
    (click)="toggleMobileMenu()"
  ></div>

  <!-- Mobile Sidebar -->
  <aside 
    class="lg:hidden fixed left-0 top-0 w-64 h-full bg-gray-800 text-white p-6 z-50 transform transition-transform duration-300"
    [class.translate-x-0]="isMobileMenuOpen"
    [class.-translate-x-full]="!isMobileMenuOpen"
  >
    <div class="flex items-center justify-between mb-8">
      <h2 class="text-xl font-semibold">My Dashboard</h2>
      <button 
        (click)="toggleMobileMenu()"
        class="text-gray-300 hover:text-white"
      >
        <span class="material-icons">close</span>
      </button>
    </div>
    <nav>
      <ul>
        <li class="mb-4">
          <a 
            (click)="navigateToSection('students')" 
            class="flex items-center p-3 rounded-lg cursor-pointer transition-colors"
            [class.bg-teal-500]="currentView === 'students'"
            [class.text-white]="currentView === 'students'"
            [class.hover:bg-gray-700]="currentView !== 'students'"
            [class.text-gray-300]="currentView !== 'students'"
          >
            <span class="material-icons mr-4" [class.text-white]="currentView === 'students'" [class.text-gray-400]="currentView !== 'students'">school</span>
            <span>Students</span>
          </a>
        </li>
        <li class="mb-4">
          <a 
            (click)="navigateToSection('courses')" 
            class="flex items-center p-3 rounded-lg cursor-pointer transition-colors"
            [class.bg-teal-500]="currentView === 'courses'"
            [class.text-white]="currentView === 'courses'"
            [class.hover:bg-gray-700]="currentView !== 'courses'"
            [class.text-gray-300]="currentView !== 'courses'"
          >
            <span class="material-icons mr-4" [class.text-white]="currentView === 'courses'" [class.text-gray-400]="currentView !== 'courses'">book</span>
            <span>Courses</span>
          </a>
        </li>
        <li class="mb-4">
          <a 
            (click)="navigateToSection('overview')" 
            class="flex items-center p-3 rounded-lg cursor-pointer transition-colors"
            [class.bg-teal-500]="currentView === 'overview'"
            [class.text-white]="currentView === 'overview'"
            [class.hover:bg-gray-700]="currentView !== 'overview'"
            [class.text-gray-300]="currentView !== 'overview'"
          >
            <span class="material-icons mr-4" [class.text-white]="currentView === 'overview'" [class.text-gray-400]="currentView !== 'overview'">dashboard</span>
            <span>Overview</span>
          </a>
        </li>
        <li class="mb-4">
          <a 
            (click)="navigateToSection('messages')" 
            class="flex items-center p-3 rounded-lg cursor-pointer transition-colors"
            [class.bg-teal-500]="currentView === 'messages'"
            [class.text-white]="currentView === 'messages'"
            [class.hover:bg-gray-700]="currentView !== 'messages'"
            [class.text-gray-300]="currentView !== 'messages'"
          >
            <span class="material-icons mr-4" [class.text-white]="currentView === 'messages'" [class.text-gray-400]="currentView !== 'messages'">chat</span>
            <span>Messages</span>
            <span *ngIf="totalUnreadMessages > 0" class="ml-auto bg-red-500 text-white text-xs rounded-full px-2 py-1 min-w-[20px] text-center">
              {{ totalUnreadMessages }}
            </span>
          </a>
        </li>
      </ul>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 p-4 lg:p-8">
    <!-- Overview Section -->
    <div *ngIf="currentView === 'overview'">
      <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center mb-6">
        <div class="flex items-center justify-between mb-4 lg:mb-0">
          <button
            class="lg:hidden p-2 text-gray-600 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-teal-500 rounded-md"
            (click)="toggleMobileMenu()"
          >
            <span class="material-icons">menu</span>
          </button>
          
          <div class="flex-1 lg:flex-none">
            <h1 class="text-2xl lg:text-3xl font-bold text-gray-800">Overview</h1>
            <p class="text-gray-500 mt-1">A quick look at your courses, students, and progress.</p>
          </div>
        </div>
      </div>

      <!-- Stats Cards -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
        <div class="bg-white p-6 rounded-xl shadow-lg flex items-center">
          <div class="bg-teal-100 p-4 rounded-full mr-4">
            <span class="material-icons text-teal-500 text-3xl">book</span>
          </div>
          <div>
            <h3 class="text-gray-500 text-sm font-medium">Total Courses</h3>
            <p class="text-3xl font-bold text-gray-800">{{ overviewStats.totalCourses }}</p>
          </div>
        </div>
        
        <div class="bg-white p-6 rounded-xl shadow-lg flex items-center">
          <div class="bg-blue-100 p-4 rounded-full mr-4">
            <span class="material-icons text-blue-500 text-3xl">school</span>
          </div>
          <div>
            <h3 class="text-gray-500 text-sm font-medium">Total Students</h3>
            <p class="text-3xl font-bold text-gray-800">{{ overviewStats.totalStudents }}</p>
          </div>
        </div>
        
        <div class="bg-white p-6 rounded-xl shadow-lg flex items-center">
          <div class="bg-green-100 p-4 rounded-full mr-4">
            <span class="material-icons text-green-500 text-3xl">check_circle</span>
          </div>
          <div>
            <h3 class="text-gray-500 text-sm font-medium">Courses Completed</h3>
            <p class="text-3xl font-bold text-gray-800">{{ overviewStats.completedCourses }}</p>
          </div>
        </div>
      </div>

      <!-- Course Progress and Top Students -->
      <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
        <!-- Course Progress -->
        <div class="xl:col-span-2 bg-white rounded-xl shadow-lg p-6">
          <h2 class="text-xl font-semibold text-gray-800 mb-4">Course Progress</h2>
          <div class="space-y-6">
            <div *ngFor="let course of courseProgress">
              <div class="flex justify-between items-center mb-1">
                <h4 class="font-medium text-gray-700">{{ course.title }}</h4>
                <span class="text-sm font-medium text-gray-600">{{ course.progress }}%</span>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-2">
                <div 
                  class="h-2 rounded-full transition-all duration-300"
                  [ngClass]="getProgressColor(course.progress)"
                  [style.width.%]="course.progress"
                ></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Top Students -->
        <div class="bg-white rounded-xl shadow-lg p-6">
          <h2 class="text-xl font-semibold text-gray-800 mb-4">Top Students</h2>
          <ul class="space-y-4">
            <li *ngFor="let student of topStudents" class="flex items-center">
              <img 
                [src]="student.avatar" 
                [alt]="student.name + ' avatar'" 
                class="w-10 h-10 rounded-full mr-4 object-cover"
              />
              <div class="flex-1">
                <h4 class="font-semibold text-gray-800">{{ student.name }}</h4>
                <p class="text-sm text-gray-500">{{ student.coursesCount }} Courses</p>
              </div>
              <span 
                class="ml-auto font-bold"
                [ngClass]="getChangeClass(student.progressChange)"
              >
                {{ getChangeText(student.progressChange) }}
              </span>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Messages View -->
    <div *ngIf="currentView === 'messages'" class="flex flex-col h-full">
      <div class="flex justify-between items-center mb-6">
        <div>
          <h1 class="text-3xl font-bold text-gray-800">Messages</h1>
          <p class="text-gray-500 mt-1">View and reply to your messages.</p>
        </div>
        <button
          class="lg:hidden p-2 text-gray-600 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-teal-500 rounded-md"
          (click)="toggleMobileMenu()"
        >
          <span class="material-icons">menu</span>
        </button>
      </div>
      
      <div class="flex flex-1 bg-white rounded-xl shadow-lg overflow-hidden">
        <!-- Conversations List -->
        <div class="w-full lg:w-1/3 border-r border-gray-200 flex flex-col">
          <div class="p-4 border-b border-gray-200">
            <input
              type="text"
              placeholder="Search messages..."
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"
              (input)="onSearchMessages($event)"
              [value]="searchTerm"
            />
          </div>
          <div class="flex-1 overflow-y-auto">
            <div *ngFor="let conversation of filteredConversations" class="p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition-colors"
                 (click)="selectConversation(conversation)"
                 [class.bg-teal-50]="activeConversation?.id === conversation.id">
              <div class="flex items-start space-x-3">
                <div class="relative">
                  <img [src]="conversation.participantAvatar" [alt]="conversation.participantName" 
                       class="w-10 h-10 rounded-full object-cover">
                  <div *ngIf="conversation.isOnline" class="absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></div>
                </div>
                <div class="flex-1 min-w-0">
                  <div class="flex justify-between items-start">
                    <h4 class="font-medium text-gray-900 truncate">{{ conversation.participantName }}</h4>
                    <span class="text-xs text-gray-500">{{ formatLastMessageTime(conversation.lastMessageTime) }}</span>
                  </div>
                  <p class="text-sm text-gray-600 truncate">{{ conversation.lastMessage }}</p>
                  <div *ngIf="conversation.unreadCount > 0" class="inline-flex items-center justify-center w-5 h-5 bg-teal-500 text-white text-xs rounded-full mt-1">
                    {{ conversation.unreadCount }}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Chat Area -->
        <div class="hidden lg:flex w-2/3 flex-col" *ngIf="activeConversation">
          <!-- Chat Header -->
          <div class="p-4 border-b border-gray-200 flex items-center">
            <img [src]="activeConversation.participantAvatar" [alt]="activeConversation.participantName" 
                 class="w-10 h-10 rounded-full object-cover mr-3">
            <div>
              <h3 class="font-medium text-gray-900">{{ activeConversation.participantName }}</h3>
              <p class="text-sm text-gray-500">{{ activeConversation.isOnline ? 'Online' : 'Offline' }}</p>
            </div>
          </div>

          <!-- Messages -->
          <div class="flex-1 p-6 overflow-y-auto bg-gray-50">
            <div *ngFor="let message of activeConversation.messages" class="mb-4">
              <div class="flex items-start space-x-3" 
                   [class.flex-row-reverse]="message.type === 'sent'"
                   [class.space-x-reverse]="message.type === 'sent'">
                <img [src]="message.senderAvatar" [alt]="message.senderName" 
                     class="w-8 h-8 rounded-full object-cover">
                <div class="max-w-xs lg:max-w-md">
                  <div class="px-4 py-2 rounded-lg"
                       [class.bg-teal-500]="message.type === 'sent'"
                       [class.text-white]="message.type === 'sent'"
                       [class.bg-white]="message.type === 'received'"
                       [class.text-gray-800]="message.type === 'received'">
                    <p class="text-sm">{{ message.content }}</p>
                  </div>
                  <p class="text-xs text-gray-500 mt-1" 
                     [class.text-right]="message.type === 'sent'">
                    {{ formatMessageTime(message.timestamp) }}
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- Message Input -->
          <div class="p-4 bg-white border-t border-gray-200">
            <div class="flex items-center space-x-4">
              <input
                type="text"
                placeholder="Type a message..."
                class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"
                [(ngModel)]="newMessage"
                (keypress)="onKeyPress($event)"
              />
              <button
                (click)="sendMessage()"
                class="bg-teal-500 text-white px-4 py-2 rounded-lg hover:bg-teal-600 transition-colors"
                [disabled]="!newMessage.trim()"
              >
                <span class="material-icons">send</span>
              </button>
            </div>
          </div>
        </div>

        <!-- No Conversation Selected -->
        <div class="hidden lg:flex w-2/3 flex-col items-center justify-center bg-gray-50" *ngIf="!activeConversation">
          <div class="text-center">
            <span class="material-icons text-gray-400 text-6xl mb-4">chat</span>
            <h3 class="text-xl font-medium text-gray-600 mb-2">Select a conversation</h3>
            <p class="text-gray-500">Choose from your existing conversations or start a new one</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Students View -->
    <div *ngIf="currentView === 'students'">
      <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center mb-8">
        <div class="flex items-center justify-between mb-4 lg:mb-0">
          <button
            class="lg:hidden p-2 text-gray-600 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-teal-500 rounded-md"
            (click)="toggleMobileMenu()"
          >
            <span class="material-icons">menu</span>
          </button>
          
          <div class="flex-1 lg:flex-none">
            <h1 class="text-2xl lg:text-3xl font-bold text-gray-800">Students</h1>
            <p class="text-gray-500 mt-1">Manage your enrolled students and track their progress.</p>
          </div>
        </div>
        
        <button 
          (click)="addStudent()"
          class="bg-teal-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-teal-600 transition duration-300 w-full lg:w-auto"
        >
          Add Student
        </button>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        <div *ngFor="let student of students" class="bg-white p-6 rounded-xl shadow-lg">
          <div class="flex items-center mb-4">
            <img [src]="student.avatar" [alt]="student.name" class="w-16 h-16 rounded-full object-cover mr-4">
            <div>
              <h3 class="text-lg font-semibold text-gray-800">{{ student.name }}</h3>
              <p class="text-sm text-gray-500">{{ student.email }}</p>
            </div>
          </div>
          
          <div class="mb-4">
            <div class="flex justify-between items-center mb-2">
              <span class="text-sm font-medium text-gray-700">Progress</span>
              <span class="text-sm font-medium text-gray-600">{{ student.progress }}%</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
              <div 
                class="bg-teal-500 h-2 rounded-full transition-all duration-300"
                [style.width.%]="student.progress"
              ></div>
            </div>
          </div>
          
          <div class="mt-4">
            <div class="flex items-center justify-between text-sm text-gray-600">
              <span>Enrolled: {{ formatDate(student.enrolledDate) }}</span>
              <div class="flex items-center">
                <span class="mr-1">Rating:</span>
                <div class="flex">
                  <span *ngFor="let star of getStarArray(student.rating)" class="text-yellow-400">
                    <span class="material-icons text-sm" *ngIf="star.filled">star</span>
                    <span class="material-icons text-sm" *ngIf="star.half">star_half</span>
                    <span class="material-icons text-sm" *ngIf="!star.filled && !star.half">star_border</span>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Courses View -->
    <div *ngIf="currentView === 'courses'">
      <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center mb-8">
        <div class="flex items-center justify-between mb-4 lg:mb-0">
          <button
            class="lg:hidden p-2 text-gray-600 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-teal-500 rounded-md"
            (click)="toggleMobileMenu()"
          >
            <span class="material-icons">menu</span>
          </button>
          
          <div class="flex-1 lg:flex-none">
            <h1 class="text-2xl lg:text-3xl font-bold text-gray-800">Courses</h1>
            <p class="text-gray-500 mt-1">Create and manage your courses and lessons.</p>
          </div>
        </div>
        
        <button 
          (click)="publishLesson()"
          class="bg-teal-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-teal-600 transition duration-300 w-full lg:w-auto"
        >
          Create Course
        </button>
      </div>

      <div class="bg-white p-6 lg:p-8 rounded-xl shadow-lg">
        <p class="text-gray-500 text-center">Courses management coming soon...</p>
      </div>
    </div>
  </main>
</div>
