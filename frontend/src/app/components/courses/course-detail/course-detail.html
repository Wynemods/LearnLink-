<div class="bg-white" *ngIf="course">
  <div class="w-full">
    <div class="relative">
      <img [src]="course.heroImage" [alt]="course.title" class="w-full h-96 object-cover">
    </div>
    
    <div class="px-8 lg:px-20">
      <!-- Navigation Tabs -->
      <div class="flex items-center space-x-4 mt-8">
        <button 
          (click)="setActiveTab('overview')"
          [class]="activeTab === 'overview' ? 'bg-teal-500 text-white' : 'bg-gray-200 text-gray-700'"
          class="py-2 px-6 rounded-md text-sm transition-colors"
        >
          Overview
        </button>
        <button 
          (click)="setActiveTab('curriculum')"
          [class]="activeTab === 'curriculum' ? 'bg-teal-500 text-white' : 'bg-gray-200 text-gray-700'"
          class="py-2 px-6 rounded-md text-sm transition-colors"
        >
          Curriculum
        </button>
        <button 
          (click)="setActiveTab('instructor')"
          [class]="activeTab === 'instructor' ? 'bg-teal-500 text-white' : 'bg-gray-200 text-gray-700'"
          class="py-2 px-6 rounded-md text-sm transition-colors"
        >
          Instructor
        </button>
        <button 
          (click)="setActiveTab('reviews')"
          [class]="activeTab === 'reviews' ? 'bg-teal-500 text-white' : 'bg-gray-200 text-gray-700'"
          class="py-2 px-6 rounded-md text-sm transition-colors"
        >
          Reviews
        </button>
      </div>

      <div class="flex flex-col lg:flex-row lg:space-x-12 mt-8">
        <!-- Main Content -->
        <div class="w-full lg:w-2/3">
          
          <!-- Overview Section -->
          <div *ngIf="activeTab === 'overview'">
            <h1 class="text-3xl font-bold text-gray-900">{{ course.title }}</h1>
            <p class="mt-4 text-gray-600">{{ course.description }}</p>
            
            <div class="mt-8">
              <h2 class="text-2xl font-bold text-gray-900">What you'll learn</h2>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 mt-4">
                <div class="flex items-start" *ngFor="let outcome of course.learningOutcomes">
                  <span class="material-icons text-teal-500 mr-3">check</span>
                  <span class="text-gray-600">{{ outcome }}</span>
                </div>
              </div>
            </div>
            
            <div class="mt-8">
              <h2 class="text-2xl font-bold text-gray-900">Requirements</h2>
              <ul class="list-disc list-inside mt-4 space-y-2 text-gray-600">
                <li *ngFor="let requirement of course.requirements">{{ requirement }}</li>
              </ul>
            </div>
          </div>

          <!-- Curriculum Section -->
          <div *ngIf="activeTab === 'curriculum'">
            <h1 class="text-3xl font-bold text-gray-900">Course Curriculum</h1>
            
            <div class="mt-6 flex justify-between items-center text-gray-600 text-sm">
              <span>{{ course.totalSections }} sections • {{ course.totalLectures }} lectures • {{ course.totalDuration }} total length</span>
              <button 
                (click)="toggleExpandAll()" 
                class="text-teal-500 font-semibold hover:text-teal-600 transition-colors"
              >
                {{ expandAllSections ? 'Collapse all sections' : 'Expand all sections' }}
              </button>
            </div>

            <div class="mt-4 border rounded-md">
              <div 
                *ngFor="let section of course.curriculum; let last = last" 
                class="accordion-item"
                [class.border-b]="!last"
              >
                <button 
                  (click)="toggleSection(section.id)"
                  class="w-full text-left p-4 bg-gray-50 hover:bg-gray-100 flex justify-between items-center transition-colors"
                >
                  <span class="font-semibold text-gray-800">{{ section.title }}</span>
                  <span class="material-icons transition-transform duration-200" 
                        [class.rotate-180]="section.isExpanded">
                    expand_more
                  </span>
                </button>
                
                <div 
                  class="accordion-content overflow-hidden transition-all duration-300 ease-in-out"
                  [class.max-h-0]="!section.isExpanded"
                  [class.max-h-96]="section.isExpanded"
                >
                  <div class="p-4 bg-white" *ngIf="section.isExpanded">
                    <div *ngFor="let lesson of section.lessons" class="lesson-item p-3 rounded-md transition-all duration-200">
                      <div class="flex items-center justify-between">
                        <div class="flex items-center">
                          <span class="material-icons text-gray-500 mr-3">{{ getLessonIcon(lesson.type) }}</span>
                          <span class="text-gray-800">{{ lesson.title }}</span>
                          <span *ngIf="lesson.isPreview" class="ml-2 text-xs bg-teal-100 text-teal-600 px-2 py-1 rounded">Preview</span>
                        </div>
                        <span class="text-gray-500 text-sm">{{ lesson.duration }}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Instructor Section -->
          <div *ngIf="activeTab === 'instructor'">
            <h1 class="text-3xl font-bold text-gray-900">Instructor</h1>
            
            <div class="mt-6 flex items-center space-x-6">
              <img 
                alt="Instructor profile picture" 
                class="w-24 h-24 rounded-full object-cover" 
                src="https://lh3.googleusercontent.com/aida-public/AB6AXuD8Q014M0S4Qx7hDGLF_D5uT7Kq2nJ2J8j6C0G9hH9v6O0P8J6Xk9r0C1E5K5f9k9l9Y9M9P9q7r3n5z4o5q5a6s4d3c2b1a0z8x7y6w5u4t3s2r1q0p"
              />
              <div>
                <h2 class="text-2xl font-semibold text-gray-800">{{ course.instructor }}</h2>
                <p class="text-gray-600">Software Engineer & Python Expert</p>
              </div>
            </div>
            
            <div class="mt-6 text-gray-700 space-y-4">
              <p>
                {{ course.instructor }} is a seasoned software engineer with over 15 years of experience in the tech industry. He has a passion for teaching and has been mentoring developers for the last 5 years. His expertise lies in Python, machine learning, and web development. He has worked for several top-tier tech companies, contributing to large-scale projects and building robust applications.
              </p>
              <p>
                In this course, {{ course.instructor }} brings his real-world experience to help you understand the subject from the ground up. He believes in a hands-on approach to learning, and the course is packed with practical examples and coding exercises.
              </p>
            </div>
            
            <div class="mt-8 grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
              <div>
                <p class="text-2xl font-bold text-teal-500">{{ course.rating }}</p>
                <p class="text-gray-600 text-sm">Instructor Rating</p>
              </div>
              <div>
                <p class="text-2xl font-bold text-teal-500">12,345</p>
                <p class="text-gray-600 text-sm">Students</p>
              </div>
              <div>
                <p class="text-2xl font-bold text-teal-500">5</p>
                <p class="text-gray-600 text-sm">Courses</p>
              </div>
              <div>
                <p class="text-2xl font-bold text-teal-500">1,234</p>
                <p class="text-gray-600 text-sm">Reviews</p>
              </div>
            </div>
          </div>

          <!-- Reviews Section -->
          <div *ngIf="activeTab === 'reviews'">
            <h1 class="text-3xl font-bold text-gray-900">Reviews</h1>
            
            <div class="mt-6 flex flex-col md:flex-row gap-8">
              <!-- Rating Summary -->
              <div class="bg-white p-6 rounded-lg shadow-md flex-shrink-0 w-full md:w-52 text-center">
                <p class="text-3xl font-bold text-gray-800">{{ course.rating }} out of 5</p>
                <div class="flex justify-center text-yellow-500 my-2">
                  <span 
                    *ngFor="let star of getStarArray(course.rating)"
                    class="material-icons"
                    [class]="star ? 'text-yellow-500' : 'text-gray-300'"
                  >
                    star
                  </span>
                </div>
                <p class="text-sm text-gray-500">Top Rating</p>
              </div>
              
              <!-- Rating Distribution -->
              <div class="flex-grow">
                <div class="flex items-center mb-2" *ngFor="let rating of [5,4,3,2,1]">
                  <p class="text-sm text-gray-600 w-16">{{ rating }} Stars</p>
                  <div class="w-full bg-gray-200 rounded-full h-2.5 mx-4">
                    <div 
                      class="bg-yellow-500 h-2.5 rounded-full rating-progress" 
                      [style.width.%]="getRatingPercentage(rating)"
                    ></div>
                  </div>
                  <p class="text-sm text-gray-600 w-12">{{ getRatingPercentage(rating) }}%</p>
                </div>
              </div>
            </div>
            
            <!-- Individual Reviews -->
            <div class="mt-8">
              <div class="mt-6" *ngFor="let review of course.reviews; let first = first" [class.mt-8]="!first">
                <div class="flex items-start space-x-4">
                  <img 
                    [src]="review.userAvatar" 
                    [alt]="review.userName + '\'s avatar'" 
                    class="w-10 h-10 rounded-full object-cover"
                  >
                  <div class="flex-grow">
                    <div class="flex items-center justify-between mb-2">
                      <h4 class="font-semibold text-gray-800">{{ review.userName }}</h4>
                      <span class="text-gray-500 text-sm">{{ review.timeAgo }}</span>
                    </div>
                    <div class="flex items-center mb-2">
                      <div class="flex text-yellow-500 mr-2">
                        <span *ngFor="let star of getStarArray(review.rating)" class="material-icons text-sm">star</span>
                      </div>
                      <span class="text-gray-600 text-sm">{{ review.rating }}/5</span>
                    </div>
                    <p class="text-gray-600">{{ review.comment }}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Sidebar -->
        <div class="w-full lg:w-1/3 lg:mt-0 mt-8">
          <div class="bg-white p-6 rounded-lg shadow-2xl relative lg:-mt-64">
            <div class="rounded-lg overflow-hidden mb-6">
              <img [src]="course.image" [alt]="course.title" class="w-full h-48 object-cover">
            </div>
            
            <!-- Price Section -->
            <div class="flex items-baseline space-x-2">
              <p class="text-3xl font-bold text-gray-900">${{ course.price }}</p>
              <p class="text-lg text-gray-400 line-through">${{ course.originalPrice }}</p>
              <p class="text-lg text-red-500 font-semibold">{{ course.discount }}% Off</p>
            </div>
            <p class="text-red-500 text-sm mt-2">11 hour left at this price</p>
            
            <!-- Buy Button -->
            <button 
              (click)="buyCourse()"
              class="w-full bg-teal-500 text-white py-3 mt-4 rounded-lg font-semibold hover:bg-teal-600 transition-colors btn-primary"
            >
              Buy Now
            </button>
            
            <!-- Course Features -->
            <div class="mt-6">
              <h3 class="font-bold text-lg text-gray-800">This Course included</h3>
              <ul class="mt-4 space-y-3 text-sm text-gray-600">
                <li class="flex items-center feature-item" *ngFor="let feature of course.features">
                  <span class="material-icons mr-3 feature-icon" [class]="getFeatureColor(feature)">
                    {{ getFeatureIcon(feature) }}
                  </span>
                  {{ feature }}
                </li>
              </ul>
            </div>
            
            <!-- Training Section -->
            <div class="mt-6 border-t pt-6">
              <h3 class="font-bold text-lg text-gray-800">Training 5 or more people</h3>
              <p class="text-sm text-gray-600 mt-2">
                Class, launched less than a year ago by Blackboard co-founder Michael Chasen, integrates exclusively...
              </p>
            </div>
            
            <!-- Share Section -->
            <div class="mt-6 border-t pt-6">
              <h3 class="font-bold text-lg text-gray-800 mb-3">Share this course</h3>
              <div class="flex space-x-2">
                <button 
                  (click)="shareOnFacebook()"
                  class="w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-600 hover:bg-gray-300 transition-colors share-btn"
                >
                  <span class="material-icons text-lg">facebook</span>
                </button>
                <button 
                  (click)="shareOnTwitter()"
                  class="w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-600 hover:bg-gray-300 transition-colors share-btn"
                >
                  <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.422.724-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.21 0-.42-.015-.63.961-.689 1.792-1.55 2.454-2.548z"/>
                  </svg>
                </button>
                <button 
                  (click)="shareViaEmail()"
                  class="w-8 h-8 flex items-center justify-center rounded-full bg-red-500 text-white hover:bg-red-600 transition-colors share-btn"
                >
                  <span class="material-icons text-lg">public</span>
                </button>
                <button 
                  (click)="copyLink()"
                  class="w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-600 hover:bg-gray-300 transition-colors share-btn"
                >
                  <span class="material-icons text-lg">link</span>
                </button>
                <button 
                  (click)="shareViaEmail()"
                  class="w-8 h-8 flex items-center justify-center rounded-full bg-gray-200 text-gray-600 hover:bg-gray-300 transition-colors share-btn"
                >
                  <span class="material-icons text-lg">mail</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Loading/Error State -->
<div *ngIf="!course" class="flex items-center justify-center min-h-screen">
  <div class="text-center">
    <p class="text-gray-500 text-lg">Course not found</p>
    <button 
      (click)="navigateToCoursesPage()"
      class="mt-4 px-6 py-2 bg-teal-500 text-white rounded-lg hover:bg-teal-600 transition-colors"
    >
      Back to Courses
    </button>
  </div>
</div>
